services:
  qbittorrent:
    image: linuxserver/qbittorrent:latest
    container_name: ab-test-qbittorrent
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=UTC
      - WEBUI_PORT=18080
    ports:
      - "18080:18080"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:18080"]
      interval: 5s
      timeout: 3s
      retries: 15
      start_period: 10s
    tmpfs:
      - /config
      - /downloads

  mock-rss:
    build:
      context: .
      dockerfile: Dockerfile.mock-rss
    container_name: ab-test-mock-rss
    ports:
      - "18888:18888"
    healthcheck:
      test: ["CMD", "python", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:18888/health')"]
      interval: 3s
      timeout: 2s
      retries: 5
      start_period: 3s
